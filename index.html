<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Safe Traffic Simulator — Full</title>
<style>
  :root{--bg:#0b1220;--card:#071124;--muted:#a9b6c6;--accent:#7dd3fc}
  body{font-family:Inter,system-ui,Arial;margin:0;background:linear-gradient(180deg,#041022,#071124);color:#eaf4ff}
  .wrap{max-width:1100px;margin:20px auto;padding:18px}
  .card{background:rgba(255,255,255,0.03);padding:14px;border-radius:10px;margin-bottom:12px}
  h1,h2{margin:0 0 8px}
  label{font-size:13px;color:var(--muted);display:block;margin-bottom:6px}
  input,select,textarea,button{font-size:14px}
  input[type="number"], input[type="text"], select, textarea{width:100%;padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);background:rgba(255,255,255,0.02);color:inherit}
  .grid{display:grid;grid-template-columns:2fr 1fr;gap:12px}
  .cols{display:grid;grid-template-columns:1fr 1fr;gap:8px}
  .small{font-size:12px;color:var(--muted)}
  .btn{background:var(--accent);border:none;padding:8px 12px;border-radius:8px;cursor:pointer;color:#022;font-weight:700}
  table{width:100%;border-collapse:collapse}
  th,td{padding:8px;border-bottom:1px solid rgba(255,255,255,0.03);text-align:left}
  .country-row{display:flex;gap:8px;margin-bottom:6px;align-items:center}
  .chip{display:inline-block;padding:6px 10px;border-radius:999px;background:rgba(125,211,252,0.06);font-weight:600}
  .danger{background:rgba(255,80,80,0.06);padding:8px;border-radius:8px;color:#ffb3b3}
  .events{max-height:160px;overflow:auto;background:rgba(0,0,0,0.06);padding:8px;border-radius:8px}
</style>
</head>
<body>
<div class="wrap">
  <div class="card">
    <h1>Safe Traffic Simulator — Full</h1>
    <div class="small">Ye tool <strong>sirf simulation</strong> karta hai — koi bhi real HTTP requests ya redirects nahi bhejta. Use for planning/testing only.</div>
  </div>

  <div class="grid">
    <!-- Controls -->
    <div class="card">
      <h2>Controls</h2>
      <div class="cols">
        <div>
          <label>Duration (minutes)</label>
          <input id="duration" type="number" min="1" value="60"/>
          <div class="small">Total simulated run time</div>
        </div>
        <div>
          <label>Views per minute</label>
          <input id="vpm" type="number" min="1" value="10"/>
          <div class="small">Average simulated views per minute</div>
        </div>
      </div>

      <div style="height:10px"></div>

      <label>Per-country allocation (enter desired total views from each)</label>
      <div id="countryAlloc" style="padding:8px;border-radius:8px;background:rgba(0,0,0,0.06);max-height:220px;overflow:auto"></div>

      <div style="height:10px"></div>

      <label>Target URL</label>
      <input id="target" type="text" placeholder="https://example.com/landing"/>

      <div style="height:10px"></div>
      <div style="display:flex;gap:8px;align-items:center">
        <button id="genBtn" class="btn">Generate Random Short URL</button>
        <button id="startBtn" class="btn">Start Simulation</button>
        <button id="stopBtn" class="btn" style="display:none;background:#ffd27d">Stop</button>
        <button id="exportBtn" class="btn" style="margin-left:auto;background:#9bd7ff;color:#012;display:none">Export CSV</button>
      </div>

      <div style="height:10px"></div>
      <div id="genInfo" class="small">No campaign generated yet.</div>
      <div style="height:10px"></div>
      <div class="danger">Reminder: I won't provide code that sends fake hits to other sites or hides/refers them through Cloudflare/analytics bypass.</div>
    </div>

    <!-- Dashboards -->
    <div>
      <div class="card">
        <h2>Overview</h2>
        <div style="display:flex;gap:10px;align-items:center">
          <div class="chip">Total Views: <span id="totalViews">0</span></div>
          <div class="chip">Generated URLs: <span id="numURLs">0</span></div>
          <div class="chip">Active Campaign: <span id="activeCamp">-</span></div>
        </div>
        <div style="height:10px"></div>

        <h3 style="margin-bottom:6px">Per-country live</h3>
        <table>
          <thead><tr><th>Country</th><th>Views</th><th>Last IP (sim)</th></tr></thead>
          <tbody id="countryTable"></tbody>
        </table>

        <div style="height:10px"></div>
        <div class="small">Recent events:</div>
        <div class="events" id="events"></div>
      </div>

      <div class="card">
        <h3>Generated Short URLs</h3>
        <table>
          <thead><tr><th>Short URL</th><th>Target</th><th>Views</th><th>Action</th></tr></thead>
          <tbody id="urlsTable"></tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<script>
// === Data & helpers ===
const COUNTRIES = ['IN','US','GB','PK','BD','ID','NG','PH','BR','DE','FR','TR','EG','Other'];
const CNAME = {IN:'India',US:'United States',GB:'United Kingdom',PK:'Pakistan',BD:'Bangladesh',ID:'Indonesia',NG:'Nigeria',PH:'Philippines',BR:'Brazil',DE:'Germany',FR:'France',TR:'Turkey',EG:'Egypt',Other:'Other'};
const IPP = {IN:['103.','106.','122.'],US:['3.','13.','52.'],GB:['51.','88.'],PK:['39.','42.'],BD:['103.100.','103.101.'],ID:['36.','103.199.'],NG:['102.','105.'],PH:['112.','118.'],BR:['191.','200.'],DE:['80.','88.'],FR:['51.','62.'],TR:['88.','94.'],EG:['102.','197.'],Other:['185.']};

let state = {running:false,interval:null,events:[],urls:[],globalCounts:{},total:0,currentCampaignId:null};

// render per-country input rows
const allocDiv = document.getElementById('countryAlloc');
COUNTRIES.forEach(cc=>{
  const row = document.createElement('div'); row.className='country-row';
  const lbl = document.createElement('div'); lbl.style.width='90px'; lbl.innerText = CNAME[cc];
  const inp = document.createElement('input'); inp.type='number'; inp.value='0'; inp.min='0'; inp.dataset.cc=cc; inp.style.flex='1';
  row.appendChild(lbl); row.appendChild(inp);
  allocDiv.appendChild(row);
});

// helpers
function randInt(a,b){ return Math.floor(Math.random()*(b-a+1))+a; }
function genIP(cc){ const p = IPP[cc]||IPP['Other']; return p[randInt(0,p.length-1)] + randInt(0,255)+'.'+randInt(0,255); }
function shortPath(){ const ch='abcdefghijklmnopqrstuvwxyz0123456789'; let s=''; for(let i=0;i<6;i++) s+=ch[randInt(0,ch.length-1)]; return '/r/'+s; }
function updateOverview(){ document.getElementById('totalViews').innerText = state.total; document.getElementById('numURLs').innerText = state.urls.length; document.getElementById('activeCamp').innerText = state.currentCampaignId || '-'; }
function renderCountryTable(){
  const tbody = document.getElementById('countryTable'); tbody.innerHTML='';
  COUNTRIES.forEach(cc=>{
    const tr = document.createElement('tr');
    const cnt = state.globalCounts[cc]||0;
    const lastIp = state.lastIp && state.lastIp[cc] ? state.lastIp[cc] : '-';
    tr.innerHTML = `<td>${CNAME[cc]}</td><td>${cnt}</td><td>${lastIp}</td>`;
    tbody.appendChild(tr);
  });
}
function renderURLs(){
  const t = document.getElementById('urlsTable'); t.innerHTML='';
  state.urls.forEach(u=>{
    const tr = document.createElement('tr');
    tr.innerHTML = `<td style="max-width:260px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis">${u.short}</td><td style="max-width:300px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis">${u.target}</td><td>${u.views}</td><td><button onclick="showDetails('${u.id}')" style="padding:6px;border-radius:6px;border:none;background:rgba(255,255,255,0.03);cursor:pointer">Details</button></td>`;
    t.appendChild(tr);
  });
}
window.showDetails = function(id){
  const u = state.urls.find(x=>x.id===id); if(!u) return alert('Not found');
  alert('Short: '+u.short+'\nTarget: '+u.target+'\nTotal views: '+u.views+'\nBy country: '+JSON.stringify(u.byCountry));
}
function renderEvents(){
  const el = document.getElementById('events'); el.innerHTML='';
  state.events.slice(0,200).forEach(e=>{
    const d = document.createElement('div'); d.style.padding='6px'; d.style.borderBottom='1px solid rgba(255,255,255,0.02)';
    d.innerHTML = `<div style="font-size:12px">${new Date(e.time).toLocaleString()} — ${CNAME[e.country]} — ${e.ip}</div><div class="small">Hit: ${e.short} → ${e.target}</div>`;
    el.appendChild(d);
  });
}

// generate campaign
document.getElementById('genBtn').addEventListener('click', ()=>{
  const target = document.getElementById('target').value.trim(); if(!target) return alert('Paste target URL first');
  const id = 'camp_'+Date.now().toString(36);
  const short = window.location.origin + shortPath() + '_' + id;
  const obj = {id:id,short:short,target:target,views:0,byCountry:{}};
  state.urls.push(obj); state.currentCampaignId = id;
  document.getElementById('genInfo').innerText = 'Generated: ' + short;
  updateOverview(); renderURLs();
  document.getElementById('exportBtn').style.display = 'inline-block';
});

// start simulation
document.getElementById('startBtn').addEventListener('click', ()=>{
  if(!state.urls.length) return alert('Generate campaign first');
  if(state.running) return alert('Already running');
  const dur = Math.max(1, parseInt(document.getElementById('duration').value)||60);
  const vpm = Math.max(1, parseInt(document.getElementById('vpm').value)||10);
  const totalPlanned = dur * vpm;

  // collect allocations
  const allocInputs = Array.from(document.querySelectorAll('#countryAlloc input'));
  const alloc = {}; let allocSum = 0;
  allocInputs.forEach(i=>{ const v = Math.max(0,parseInt(i.value)||0); alloc[i.dataset.cc]=v; allocSum+=v; });

  // create plan per country
  const plan = {};
  if(allocSum>0){
    COUNTRIES.forEach(cc=> plan[cc] = Math.round((alloc[cc]||0)/allocSum * totalPlanned));
  } else {
    // no allocation => random distribution initially zero; we'll fill remainder later
    COUNTRIES.forEach(cc=> plan[cc]=0);
  }
  // fill remainder
  let assigned = Object.values(plan).reduce((a,b)=>a+b,0);
  while(assigned < totalPlanned){
    const idx = randInt(0,COUNTRIES.length-1);
    plan[COUNTRIES[idx]] = (plan[COUNTRIES[idx]]||0)+1; assigned++;
  }

  // choose last generated campaign as active
  const active = state.urls[state.urls.length-1];
  active.plan = Object.assign({},plan);
  active.byCountry = active.byCountry || {};
  // start fast simulation: 1 second = 1 minute
  let minute = 0; state.running = true; document.getElementById('stopBtn').style.display='inline-block'; document.getElementById('startBtn').style.display='none';

  state.interval = setInterval(()=>{
    if(minute >= dur){ stopSim(); return; }
    // generate vpm events this minute
    for(let i=0;i<vpm;i++){
      // select country with remaining quota
      const available = COUNTRIES.filter(cc=> (active.plan[cc]||0) > (active.byCountry[cc]||0));
      const chosen = available.length ? available[randInt(0,available.length-1)] : COUNTRIES[randInt(0,COUNTRIES.length-1)];
      const ip = genIP(chosen);
      const ev = {time:new Date().toISOString(),country:chosen,ip:ip,short:active.short,target:active.target};
      state.events.unshift(ev);
      state.total += 1;
      state.globalCounts[chosen] = (state.globalCounts[chosen]||0) + 1;
      state.lastIp = state.lastIp || {}; state.lastIp[chosen] = ip;
      active.views = (active.views||0) + 1;
      active.byCountry[chosen] = (active.byCountry[chosen]||0) + 1;
    }
    minute++;
    updateOverview(); renderCountryTable(); renderURLs(); renderEvents();
  }, 1000);
});

// stop
document.getElementById('stopBtn').addEventListener('click', stopSim);
function stopSim(){
  if(state.interval) clearInterval(state.interval);
  state.running = false; state.interval = null;
  document.getElementById('stopBtn').style.display='none'; document.getElementById('startBtn').style.display='inline-block';
  alert('Simulation stopped (local simulation only).');
}

// export CSV
document.getElementById('exportBtn').addEventListener('click', ()=>{
  if(!state.events.length) return alert('No events to export');
  const hdr = ['id','time','country','ip','short','target'];
  const rows = [hdr.join(',')];
  state.events.slice().reverse().forEach((e,i)=>{
    const line = [i+1, `"${e.time}"`, `"${CNAME[e.country]}"`, e.ip, `"${e.short}"`, `"${e.target}"`].join(',');
    rows.push(line);
  });
  const blob = new Blob([rows.join('\n')], {type:'text/csv'});
  const url = URL.createObjectURL(blob); const a = document.createElement('a'); a.href=url; a.download='sim_events.csv'; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
});

// initial rendering
updateOverview(); renderCountryTable(); renderURLs(); renderEvents();
</script>
</body>
</html>      <label>Choose visits per hour (number)</label>
      <input id="visitsPerHour" type="number" min="1" value="10" />
      <div class="small">Har ek ghante ke liye yeh visits generate honge (simulation)</div>
    </div>

    <div>
      <label>How many hours to run</label>
      <input id="hours" type="number" min="1" value="4" />
      <div class="small">Total hours ke liye schedule banega</div>
    </div>

    <div class="full">
      <label>Select country / countries (hold Ctrl / Cmd for multi-select)</label>
      <select id="countries" multiple size="6">
        <option value="ALL">All Countries (random)</option>
        <option value="IN">India</option>
        <option value="US">United States</option>
        <option value="PK">Pakistan</option>
        <option value="BD">Bangladesh</option>
        <option value="GB">United Kingdom</option>
        <option value="ID">Indonesia</option>
        <option value="NG">Nigeria</option>
        <option value="PH">Philippines</option>
        <option value="RU">Russia</option>
        <option value="TR">Turkey</option>
        <option value="BR">Brazil</option>
        <option value="DE">Germany</option>
        <option value="FR">France</option>
        <option value="EG">Egypt</option>
        <option value="Other">Other</option>
      </select>
      <div class="small">Agar <strong>All Countries</strong> choose kiya, toh generator random countries assign karega.</div>
    </div>

    <div>
      <label>IP Variety</label>
      <select id="ipVariety">
        <option value="random">Random different IPs</option>
        <option value="same">Same IP (single)</option>
      </select>
      <div class="small">Simulation me IPs kaise dikhna chahiye</div>
    </div>

    <div>
      <label>Campaign label (optional)</label>
      <input id="campaign" type="text" placeholder="e.g. promo_1" />
    </div>

    <div class="full">
      <label>Target URL (paste here)</label>
      <input id="targetUrl" type="text" placeholder="https://example.com/page-to-send-traffic" />
    </div>

    <div class="full">
      <label>Extra notes / custom UA (optional)</label>
      <textarea id="notes" rows="2" placeholder="E.g. Prefer mobile-only, custom user-agent... (simulated)"></textarea>
    </div>

    <div class="full" style="display:flex;gap:10px;align-items:center">
      <button id="generateBtn">Generate Schedule</button>
      <button id="downloadBtn" style="background:#9bd7ff;color:#012;display:none">Download CSV</button>
      <div class="muted" style="margin-left:auto">Preview only — no network requests sent.</div>
    </div>

  </div>

  <div id="result" class="preview" style="display:none">
    <div style="display:flex;align-items:center;justify-content:space-between">
      <div>
        <span class="chip">Total hits: <span id="totalHits">0</span></span>
        <span class="chip">Hours: <span id="outHours">0</span></span>
        <span class="chip">Campaign: <span id="outCampaign">-</span></span>
      </div>
      <div class="small">Note: This is a simulated schedule table (timestamps, country, IP)</div>
    </div>

    <div style="height:10px"></div>
    <table id="tableOut">
      <thead><tr><th>#</th><th>Timestamp (sim)</th><th>Country</th><th>IP</th><th>Target URL</th></tr></thead>
      <tbody></tbody>
    </table>
  </div>

  <div class="note">
    Important: Yeh tool <strong>sirf UI &amp; schedule generator</strong> hai. Main intentionally koi code nahi likha jo remote servers par automated requests bheje. Automated traffic generation jo kisi site ke analytics ko manipulate kare — woh unethical aur platform terms-of-service ka violation ho sakta hai. Agar tum real traffic chahte ho, toh legitimate channels use karo (SEO, paid ads, partnerships, content syndication).
  </div>

</div>

  </div>  <script>
    // Utility: random IPv4
    function randInt(min, max){ return Math.floor(Math.random()*(max-min+1))+min }
    function randomIP(){ return randInt(1,255)+'.'+randInt(0,255)+'.'+randInt(0,255)+'.'+randInt(1,254) }

    // Country code to nice name (partial list)
    const countryNames = {
      'IN':'India','US':'United States','PK':'Pakistan','BD':'Bangladesh','GB':'United Kingdom','ID':'Indonesia','NG':'Nigeria','PH':'Philippines','RU':'Russia','TR':'Turkey','BR':'Brazil','DE':'Germany','FR':'France','EG':'Egypt','Other':'Other'
    }

    function chooseCountry(selected){
      if(selected.length===0) return ['Other']
      if(selected.includes('ALL')){
        // pick random country from list (excluding ALL)
        const keys = Object.keys(countryNames)
        return [keys[randInt(0,keys.length-1)]]
      }
      return selected
    }

    document.getElementById('generateBtn').addEventListener('click', ()=>{
      const visitsPerHour = parseInt(document.getElementById('visitsPerHour').value)||0
      const hours = parseInt(document.getElementById('hours').value)||0
      const targetUrl = document.getElementById('targetUrl').value.trim()
      const campaign = document.getElementById('campaign').value.trim() || '-'
      const ipMode = document.getElementById('ipVariety').value
      const notes = document.getElementById('notes').value

      // Collect selected countries
      const sel = Array.from(document.getElementById('countries').selectedOptions).map(o=>o.value)
      const countries = sel.length?sel:['Other']

      // Basic validation
      if(!targetUrl){ alert('Paste the target URL first.'); return }
      if(visitsPerHour<=0 || hours<=0){ alert('Enter valid visits per hour and hours.'); return }
      if(visitsPerHour*hours > 20000){ if(!confirm('You are generating a big schedule ('+(visitsPerHour*hours)+' hits). Continue?')) return }

      // Build schedule
      const rows = []
      let counter = 0
      const now = new Date()
      for(let h=0; h<hours; h++){
        for(let v=0; v<visitsPerHour; v++){
          counter++
          // timestamp: spread within the hour
          const t = new Date(now.getTime() + h*3600*1000 + randInt(0,3599)*1000)
          // pick country
          const chosen = chooseCountry(countries)
          const country = chosen[ randInt(0, chosen.length-1) ]
          // ip
          let ip = ipMode==='same'? '203.0.113.42' : randomIP()
          // optionally add small location hint
          const cname = countryNames[country] || country
          rows.push({id:counter, ts:t.toISOString(), country:cname, ip:ip, url:targetUrl, campaign:campaign, notes:notes})
        }
      }

      // Render table
      const tbody = document.querySelector('#tableOut tbody')
      tbody.innerHTML=''
      rows.forEach(r=>{
        const tr = document.createElement('tr')
        tr.innerHTML = `<td>${r.id}</td><td>${r.ts}</td><td>${r.country}</td><td>${r.ip}</td><td style="max-width:300px;overflow:hidden;text-overflow:ellipsis">${r.url}</td>`
        tbody.appendChild(tr)
      })

      document.getElementById('totalHits').innerText = rows.length
      document.getElementById('outHours').innerText = hours
      document.getElementById('outCampaign').innerText = campaign
      document.getElementById('result').style.display = 'block'

      // Prepare CSV content for download
      const csvRows = []
      csvRows.push(['id','timestamp','country','ip','url','campaign','notes'].join(','))
      rows.forEach(r=>{
        // escape commas
        const line = [r.id, r.ts, '"'+r.country+'"', r.ip, '"'+r.url+'"', r.campaign, '"'+(r.notes||'')+'"'].join(',')
        csvRows.push(line)
      })
      const csvData = csvRows.join('\n')

      // Attach download
      const dl = document.getElementById('downloadBtn')
      dl.style.display='inline-block'
      dl.onclick = ()=>{
        const blob = new Blob([csvData], {type:'text/csv;charset=utf-8;'});
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a'); a.href = url; a.download = 'traffic_schedule.csv'; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
      }

    })

  </script></body>
          </html>      <label>Choose visits per hour (number)</label>
      <input id="visitsPerHour" type="number" min="1" value="10" />
      <div class="small">Har ek ghante ke liye yeh visits generate honge (simulation)</div>
    </div>

    <div>
      <label>How many hours to run</label>
      <input id="hours" type="number" min="1" value="4" />
      <div class="small">Total hours ke liye schedule banega</div>
    </div>

    <div class="full">
      <label>Select country / countries (hold Ctrl / Cmd for multi-select)</label>
      <select id="countries" multiple size="6">
        <option value="ALL">All Countries (random)</option>
        <option value="IN">India</option>
        <option value="US">United States</option>
        <option value="PK">Pakistan</option>
        <option value="BD">Bangladesh</option>
        <option value="GB">United Kingdom</option>
        <option value="ID">Indonesia</option>
        <option value="NG">Nigeria</option>
        <option value="PH">Philippines</option>
        <option value="RU">Russia</option>
        <option value="TR">Turkey</option>
        <option value="BR">Brazil</option>
        <option value="DE">Germany</option>
        <option value="FR">France</option>
        <option value="EG">Egypt</option>
        <option value="Other">Other</option>
      </select>
      <div class="small">Agar <strong>All Countries</strong> choose kiya, toh generator random countries assign karega.</div>
    </div>

    <div>
      <label>IP Variety</label>
      <select id="ipVariety">
        <option value="random">Random different IPs</option>
        <option value="same">Same IP (single)</option>
      </select>
      <div class="small">Simulation me IPs kaise dikhna chahiye</div>
    </div>

    <div>
      <label>Campaign label (optional)</label>
      <input id="campaign" type="text" placeholder="e.g. promo_1" />
    </div>

    <div class="full">
      <label>Target URL (paste here)</label>
      <input id="targetUrl" type="text" placeholder="https://example.com/page-to-send-traffic" />
    </div>

    <div class="full">
      <label>Extra notes / custom UA (optional)</label>
      <textarea id="notes" rows="2" placeholder="E.g. Prefer mobile-only, custom user-agent... (simulated)"></textarea>
    </div>

    <div class="full" style="display:flex;gap:10px;align-items:center">
      <button id="generateBtn">Generate Schedule</button>
      <button id="downloadBtn" style="background:#9bd7ff;color:#012;display:none">Download CSV</button>
      <div class="muted" style="margin-left:auto">Preview only — no network requests sent.</div>
    </div>

  </div>

  <div id="result" class="preview" style="display:none">
    <div style="display:flex;align-items:center;justify-content:space-between">
      <div>
        <span class="chip">Total hits: <span id="totalHits">0</span></span>
        <span class="chip">Hours: <span id="outHours">0</span></span>
        <span class="chip">Campaign: <span id="outCampaign">-</span></span>
      </div>
      <div class="small">Note: This is a simulated schedule table (timestamps, country, IP)</div>
    </div>

    <div style="height:10px"></div>
    <table id="tableOut">
      <thead><tr><th>#</th><th>Timestamp (sim)</th><th>Country</th><th>IP</th><th>Target URL</th></tr></thead>
      <tbody></tbody>
    </table>
  </div>

  <div class="note">
    Important: Yeh tool <strong>sirf UI &amp; schedule generator</strong> hai. Main intentionally koi code nahi likha jo remote servers par automated requests bheje. Automated traffic generation jo kisi site ke analytics ko manipulate kare — woh unethical aur platform terms-of-service ka violation ho sakta hai. Agar tum real traffic chahte ho, toh legitimate channels use karo (SEO, paid ads, partnerships, content syndication).
  </div>

</div>

  </div>  <script>
    // Utility: random IPv4
    function randInt(min, max){ return Math.floor(Math.random()*(max-min+1))+min }
    function randomIP(){ return randInt(1,255)+'.'+randInt(0,255)+'.'+randInt(0,255)+'.'+randInt(1,254) }

    // Country code to nice name (partial list)
    const countryNames = {
      'IN':'India','US':'United States','PK':'Pakistan','BD':'Bangladesh','GB':'United Kingdom','ID':'Indonesia','NG':'Nigeria','PH':'Philippines','RU':'Russia','TR':'Turkey','BR':'Brazil','DE':'Germany','FR':'France','EG':'Egypt','Other':'Other'
    }

    function chooseCountry(selected){
      if(selected.length===0) return ['Other']
      if(selected.includes('ALL')){
        // pick random country from list (excluding ALL)
        const keys = Object.keys(countryNames)
        return [keys[randInt(0,keys.length-1)]]
      }
      return selected
    }

    document.getElementById('generateBtn').addEventListener('click', ()=>{
      const visitsPerHour = parseInt(document.getElementById('visitsPerHour').value)||0
      const hours = parseInt(document.getElementById('hours').value)||0
      const targetUrl = document.getElementById('targetUrl').value.trim()
      const campaign = document.getElementById('campaign').value.trim() || '-'
      const ipMode = document.getElementById('ipVariety').value
      const notes = document.getElementById('notes').value

      // Collect selected countries
      const sel = Array.from(document.getElementById('countries').selectedOptions).map(o=>o.value)
      const countries = sel.length?sel:['Other']

      // Basic validation
      if(!targetUrl){ alert('Paste the target URL first.'); return }
      if(visitsPerHour<=0 || hours<=0){ alert('Enter valid visits per hour and hours.'); return }
      if(visitsPerHour*hours > 20000){ if(!confirm('You are generating a big schedule ('+(visitsPerHour*hours)+' hits). Continue?')) return }

      // Build schedule
      const rows = []
      let counter = 0
      const now = new Date()
      for(let h=0; h<hours; h++){
        for(let v=0; v<visitsPerHour; v++){
          counter++
          // timestamp: spread within the hour
          const t = new Date(now.getTime() + h*3600*1000 + randInt(0,3599)*1000)
          // pick country
          const chosen = chooseCountry(countries)
          const country = chosen[ randInt(0, chosen.length-1) ]
          // ip
          let ip = ipMode==='same'? '203.0.113.42' : randomIP()
          // optionally add small location hint
          const cname = countryNames[country] || country
          rows.push({id:counter, ts:t.toISOString(), country:cname, ip:ip, url:targetUrl, campaign:campaign, notes:notes})
        }
      }

      // Render table
      const tbody = document.querySelector('#tableOut tbody')
      tbody.innerHTML=''
      rows.forEach(r=>{
        const tr = document.createElement('tr')
        tr.innerHTML = `<td>${r.id}</td><td>${r.ts}</td><td>${r.country}</td><td>${r.ip}</td><td style="max-width:300px;overflow:hidden;text-overflow:ellipsis">${r.url}</td>`
        tbody.appendChild(tr)
      })

      document.getElementById('totalHits').innerText = rows.length
      document.getElementById('outHours').innerText = hours
      document.getElementById('outCampaign').innerText = campaign
      document.getElementById('result').style.display = 'block'

      // Prepare CSV content for download
      const csvRows = []
      csvRows.push(['id','timestamp','country','ip','url','campaign','notes'].join(','))
      rows.forEach(r=>{
        // escape commas
        const line = [r.id, r.ts, '"'+r.country+'"', r.ip, '"'+r.url+'"', r.campaign, '"'+(r.notes||'')+'"'].join(',')
        csvRows.push(line)
      })
      const csvData = csvRows.join('\n')

      // Attach download
      const dl = document.getElementById('downloadBtn')
      dl.style.display='inline-block'
      dl.onclick = ()=>{
        const blob = new Blob([csvData], {type:'text/csv;charset=utf-8;'});
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a'); a.href = url; a.download = 'traffic_schedule.csv'; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
      }

    })

  </script></body>
  </html>
